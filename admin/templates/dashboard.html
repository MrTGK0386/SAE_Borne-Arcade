<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>En-tête Latéral</title>
    <link rel="stylesheet" href="../static/css/dashboard.css">
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</head>

<header class="sidebar-header" style="display: flex;flex-direction: column;justify-content: space-between;">
    <h2>Tableau de bord</h2>
    <a href="/logout" style="margin-bottom: 40px;"><?xml version="1.0" encoding="utf-8"?>
        <svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.9999 2C10.2385 2 7.99991 4.23858 7.99991 7C7.99991 7.55228 8.44762 8 8.99991 8C9.55219 8 9.99991 7.55228 9.99991 7C9.99991 5.34315 11.3431 4 12.9999 4H16.9999C18.6568 4 19.9999 5.34315 19.9999 7V17C19.9999 18.6569 18.6568 20 16.9999 20H12.9999C11.3431 20 9.99991 18.6569 9.99991 17C9.99991 16.4477 9.55219 16 8.99991 16C8.44762 16 7.99991 16.4477 7.99991 17C7.99991 19.7614 10.2385 22 12.9999 22H16.9999C19.7613 22 21.9999 19.7614 21.9999 17V7C21.9999 4.23858 19.7613 2 16.9999 2H12.9999Z" fill="#fff"/>
        <path d="M13.9999 11C14.5522 11 14.9999 11.4477 14.9999 12C14.9999 12.5523 14.5522 13 13.9999 13V11Z" fill="#000000"/>
        <path d="M5.71783 11C5.80685 10.8902 5.89214 10.7837 5.97282 10.682C6.21831 10.3723 6.42615 10.1004 6.57291 9.90549C6.64636 9.80795 6.70468 9.72946 6.74495 9.67492L6.79152 9.61162L6.804 9.59454L6.80842 9.58848C6.80846 9.58842 6.80892 9.58778 5.99991 9L6.80842 9.58848C7.13304 9.14167 7.0345 8.51561 6.58769 8.19098C6.14091 7.86637 5.51558 7.9654 5.19094 8.41215L5.18812 8.41602L5.17788 8.43002L5.13612 8.48679C5.09918 8.53682 5.04456 8.61033 4.97516 8.7025C4.83623 8.88702 4.63874 9.14542 4.40567 9.43937C3.93443 10.0337 3.33759 10.7481 2.7928 11.2929L2.08569 12L2.7928 12.7071C3.33759 13.2519 3.93443 13.9663 4.40567 14.5606C4.63874 14.8546 4.83623 15.113 4.97516 15.2975C5.04456 15.3897 5.09918 15.4632 5.13612 15.5132L5.17788 15.57L5.18812 15.584L5.19045 15.5872C5.51509 16.0339 6.14091 16.1336 6.58769 15.809C7.0345 15.4844 7.13355 14.859 6.80892 14.4122L5.99991 15C6.80892 14.4122 6.80897 14.4123 6.80892 14.4122L6.804 14.4055L6.79152 14.3884L6.74495 14.3251C6.70468 14.2705 6.64636 14.1921 6.57291 14.0945C6.42615 13.8996 6.21831 13.6277 5.97282 13.318C5.89214 13.2163 5.80685 13.1098 5.71783 13H13.9999V11H5.71783Z" fill="#fff"/>
        </svg></a>
</header>

<body>
    <div class="main-content">
        <div class="content-header">
            <div class="content-header-container">
                <div class="container">
                    <div style="display: flex;flex-direction: row;justify-content:space-between;">
                        <div class="container-header-left">
                            <h4>Status de la borne</h4>
                        </div>
                        <div class="container-header-right">
                            <a id="openModalBtn">
                                <?xml version="1.0" encoding="utf-8"?>
                                <svg width="800px" height="800px" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M12.0002 8C9.79111 8 8.00024 9.79086 8.00024 12C8.00024 14.2091 9.79111 16 12.0002 16C14.2094 16 16.0002 14.2091 16.0002 12C16.0002 9.79086 14.2094 8 12.0002 8ZM10.0002 12C10.0002 10.8954 10.8957 10 12.0002 10C13.1048 10 14.0002 10.8954 14.0002 12C14.0002 13.1046 13.1048 14 12.0002 14C10.8957 14 10.0002 13.1046 10.0002 12Z"
                                        fill="#000000" />
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M11.2867 0.5C9.88583 0.5 8.6461 1.46745 8.37171 2.85605L8.29264 3.25622C8.10489 4.20638 7.06195 4.83059 6.04511 4.48813L5.64825 4.35447C4.32246 3.90796 2.83873 4.42968 2.11836 5.63933L1.40492 6.83735C0.67773 8.05846 0.954349 9.60487 2.03927 10.5142L2.35714 10.7806C3.12939 11.4279 3.12939 12.5721 2.35714 13.2194L2.03927 13.4858C0.954349 14.3951 0.67773 15.9415 1.40492 17.1626L2.11833 18.3606C2.83872 19.5703 4.3225 20.092 5.64831 19.6455L6.04506 19.5118C7.06191 19.1693 8.1049 19.7935 8.29264 20.7437L8.37172 21.1439C8.6461 22.5325 9.88584 23.5 11.2867 23.5H12.7136C14.1146 23.5 15.3543 22.5325 15.6287 21.1438L15.7077 20.7438C15.8954 19.7936 16.9384 19.1693 17.9553 19.5118L18.3521 19.6455C19.6779 20.092 21.1617 19.5703 21.8821 18.3606L22.5955 17.1627C23.3227 15.9416 23.046 14.3951 21.9611 13.4858L21.6432 13.2194C20.8709 12.5722 20.8709 11.4278 21.6432 10.7806L21.9611 10.5142C23.046 9.60489 23.3227 8.05845 22.5955 6.83732L21.8821 5.63932C21.1617 4.42968 19.678 3.90795 18.3522 4.35444L17.9552 4.48814C16.9384 4.83059 15.8954 4.20634 15.7077 3.25617L15.6287 2.85616C15.3543 1.46751 14.1146 0.5 12.7136 0.5H11.2867ZM10.3338 3.24375C10.4149 2.83334 10.7983 2.5 11.2867 2.5H12.7136C13.2021 2.5 13.5855 2.83336 13.6666 3.24378L13.7456 3.64379C14.1791 5.83811 16.4909 7.09167 18.5935 6.38353L18.9905 6.24984C19.4495 6.09527 19.9394 6.28595 20.1637 6.66264L20.8771 7.86064C21.0946 8.22587 21.0208 8.69271 20.6764 8.98135L20.3586 9.24773C18.6325 10.6943 18.6325 13.3057 20.3586 14.7523L20.6764 15.0186C21.0208 15.3073 21.0946 15.7741 20.8771 16.1394L20.1637 17.3373C19.9394 17.714 19.4495 17.9047 18.9905 17.7501L18.5936 17.6164C16.4909 16.9082 14.1791 18.1618 13.7456 20.3562L13.6666 20.7562C13.5855 21.1666 13.2021 21.5 12.7136 21.5H11.2867C10.7983 21.5 10.4149 21.1667 10.3338 20.7562L10.2547 20.356C9.82113 18.1617 7.50931 16.9082 5.40665 17.6165L5.0099 17.7501C4.55092 17.9047 4.06104 17.714 3.83671 17.3373L3.1233 16.1393C2.9058 15.7741 2.97959 15.3073 3.32398 15.0186L3.64185 14.7522C5.36782 13.3056 5.36781 10.6944 3.64185 9.24779L3.32398 8.98137C2.97959 8.69273 2.9058 8.2259 3.1233 7.86067L3.83674 6.66266C4.06106 6.28596 4.55093 6.09528 5.0099 6.24986L5.40676 6.38352C7.50938 7.09166 9.82112 5.83819 10.2547 3.64392L10.3338 3.24375Z"
                                        fill="#000000" />
                                </svg>
                            </a>
                        </div>
                    </div>
                    <div class="container-statusIcon">
                        {{arcade_status_svg | safe}}
                    </div>
                    <div class="container-status">
                        <p>{{arcade_status_text}}</p>
                    </div>
                </div>
                <div class="container">
                    <div style="display: flex;flex-direction: row;justify-content:space-between;">
                        <div class="container-header-left">
                            <h4>Status des dépôts</h4>
                        </div>
                        <div class="container-header-right">
                            <a id="openModalBtn_2">
                                <?xml version="1.0" encoding="utf-8"?>
                                <svg width="800px" height="800px" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M12.0002 8C9.79111 8 8.00024 9.79086 8.00024 12C8.00024 14.2091 9.79111 16 12.0002 16C14.2094 16 16.0002 14.2091 16.0002 12C16.0002 9.79086 14.2094 8 12.0002 8ZM10.0002 12C10.0002 10.8954 10.8957 10 12.0002 10C13.1048 10 14.0002 10.8954 14.0002 12C14.0002 13.1046 13.1048 14 12.0002 14C10.8957 14 10.0002 13.1046 10.0002 12Z"
                                        fill="#000000" />
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M11.2867 0.5C9.88583 0.5 8.6461 1.46745 8.37171 2.85605L8.29264 3.25622C8.10489 4.20638 7.06195 4.83059 6.04511 4.48813L5.64825 4.35447C4.32246 3.90796 2.83873 4.42968 2.11836 5.63933L1.40492 6.83735C0.67773 8.05846 0.954349 9.60487 2.03927 10.5142L2.35714 10.7806C3.12939 11.4279 3.12939 12.5721 2.35714 13.2194L2.03927 13.4858C0.954349 14.3951 0.67773 15.9415 1.40492 17.1626L2.11833 18.3606C2.83872 19.5703 4.3225 20.092 5.64831 19.6455L6.04506 19.5118C7.06191 19.1693 8.1049 19.7935 8.29264 20.7437L8.37172 21.1439C8.6461 22.5325 9.88584 23.5 11.2867 23.5H12.7136C14.1146 23.5 15.3543 22.5325 15.6287 21.1438L15.7077 20.7438C15.8954 19.7936 16.9384 19.1693 17.9553 19.5118L18.3521 19.6455C19.6779 20.092 21.1617 19.5703 21.8821 18.3606L22.5955 17.1627C23.3227 15.9416 23.046 14.3951 21.9611 13.4858L21.6432 13.2194C20.8709 12.5722 20.8709 11.4278 21.6432 10.7806L21.9611 10.5142C23.046 9.60489 23.3227 8.05845 22.5955 6.83732L21.8821 5.63932C21.1617 4.42968 19.678 3.90795 18.3522 4.35444L17.9552 4.48814C16.9384 4.83059 15.8954 4.20634 15.7077 3.25617L15.6287 2.85616C15.3543 1.46751 14.1146 0.5 12.7136 0.5H11.2867ZM10.3338 3.24375C10.4149 2.83334 10.7983 2.5 11.2867 2.5H12.7136C13.2021 2.5 13.5855 2.83336 13.6666 3.24378L13.7456 3.64379C14.1791 5.83811 16.4909 7.09167 18.5935 6.38353L18.9905 6.24984C19.4495 6.09527 19.9394 6.28595 20.1637 6.66264L20.8771 7.86064C21.0946 8.22587 21.0208 8.69271 20.6764 8.98135L20.3586 9.24773C18.6325 10.6943 18.6325 13.3057 20.3586 14.7523L20.6764 15.0186C21.0208 15.3073 21.0946 15.7741 20.8771 16.1394L20.1637 17.3373C19.9394 17.714 19.4495 17.9047 18.9905 17.7501L18.5936 17.6164C16.4909 16.9082 14.1791 18.1618 13.7456 20.3562L13.6666 20.7562C13.5855 21.1666 13.2021 21.5 12.7136 21.5H11.2867C10.7983 21.5 10.4149 21.1667 10.3338 20.7562L10.2547 20.356C9.82113 18.1617 7.50931 16.9082 5.40665 17.6165L5.0099 17.7501C4.55092 17.9047 4.06104 17.714 3.83671 17.3373L3.1233 16.1393C2.9058 15.7741 2.97959 15.3073 3.32398 15.0186L3.64185 14.7522C5.36782 13.3056 5.36781 10.6944 3.64185 9.24779L3.32398 8.98137C2.97959 8.69273 2.9058 8.2259 3.1233 7.86067L3.83674 6.66266C4.06106 6.28596 4.55093 6.09528 5.0099 6.24986L5.40676 6.38352C7.50938 7.09166 9.82112 5.83819 10.2547 3.64392L10.3338 3.24375Z"
                                        fill="#000000" />
                                </svg>
                            </a>
                        </div>
                    </div>
                    <div class="container-statusIcon">
                        {{upload_status_svg | safe}}
                    </div>
                    <div class="container-status">
                        <p>{{upload_status_text}}</p>
                    </div>
                </div>
                <div class="container">
                    <h4>Téléverser un jeu</h4>
                    <div class="container-statusIcon">
                        <a href=""><svg width="135" height="135" viewBox="0 0 135 135" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M67.5 130C32.9822 130 5 102.018 5 67.5C5 32.9822 32.9822 5 67.5 5"
                                    stroke="#4ECB71" stroke-width="10" stroke-linecap="round" />
                                <path d="M67.5 5C102.018 5 130 32.9822 130 67.5C130 102.018 102.018 130 67.5 130"
                                    stroke="#4ECB71" stroke-width="10" stroke-linecap="round" />
                                <path d="M67.5 95.2778V43.1945" stroke="#4ECB71" stroke-width="10"
                                    stroke-linecap="round" />
                                <path d="M91.8056 67.5L67.5 43.1945L43.1945 67.5" stroke="#4ECB71" stroke-width="10"
                                    stroke-linecap="round" />
                            </svg>
                        </a>
                    </div>
                    <div class="container-status">
                        <p>Téléverser un Jeu</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="content-body">
            <div class="container-left">
                <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Rechercher...">
                <div class="overflow">
                    <table id="gameTable">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Nom</th>
                                <th style="text-align: center;">Version</th>
                                <th style="text-align: center;">Launcher</th>
                                <th style="text-align: center;">Date d'ajout</th>
                                <th style="text-align: center;">Temps de jeu</th>
                                <th>Modifier</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for game in all_games %}
                            <tr>
                                <td style="display: flex;">{{ game.status_svg | safe }}</td>
                                <td>{{ game.name | safe | urldecode}}</td>
                                <td style="text-align: center;">{{ game.version }}</td>
                                <td style="text-align: center;">{{ game.launcherType }}</td>
                                <td style="text-align: center;">{{ game.formatted_uploadDate }}</td>
                                <td style="text-align: center;">{{ game.formatted_duration }}</td>
                                <td style="text-align: center;">{{ game.modify | safe}}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="container-right">
                <div>
                    <div id="chartContainer" style="height: 500px; width: 100%;"></div>
                </div>
            </div>
        </div>
        <div id="modal" class="modal">
            <div class="modal-content">
                <div style="display: flex;flex-direction: row; justify-content: space-between; margin-bottom: 20px;">
                    <div style="display: flex;flex-direction: column; justify-content: center;">
                        <h4>Changer le status de la borne</h4>
                    </div>
                    <div>
                        <span class="close">&times;</span>
                    </div>
                </div>
                <div>
                    <form id="arcadeForm" action="/change_arcade_status" method="post" style="display: flex;flex-direction: column; align-items: center;">
                        <select name="arcade_status" id="arcadeStatus">
                            <option value="2">Lancer l'arcade</option>
                            <option value="1">Mettre en maintenance</option>
                            <option value="0">Arrêter l'arcade</option>
                        </select>
                        <button type="submit">Confirmer</button>
                    </form>
                </div>
            </div>
          </div>
          <div id="modal_2" class="modal">
            <div class="modal-content">
                <div style="display: flex;flex-direction: row; justify-content: space-between; margin-bottom: 20px;">
                    <div style="display: flex;flex-direction: column; justify-content: center;">
                        <h4>Changer le status de la borne</h4>
                    </div>
                    <div>
                        <span class="close_2">&times;</span>
                    </div>
                </div>
                <div>
                    <form id="arcadeForm" action="/change_upload_status" method="post" style="display: flex;flex-direction: column; align-items: center;">
                        <select name="upload_status" id="arcadeStatus">
                            <option value="1">Ouvrir les dépôts</option>
                            <option value="0">Fermer les dépôts</option>
                        </select>
                        <button type="submit">Confirmer</button>
                    </form>
                </div>
            </div>
          </div>
    </div>
    <script>
        var modal = document.getElementById("modal");
        var openModalBtn = document.getElementById("openModalBtn");
        var closeBtn = document.getElementsByClassName("close")[0];
        var modal_2 = document.getElementById("modal_2");
        var openModalBtn_2 = document.getElementById("openModalBtn_2");
        var closeBtn_2 = document.getElementsByClassName("close_2")[0];

        openModalBtn.onclick = function() {
        modal.style.display = "block";
        }
        openModalBtn_2.onclick = function() {
        modal_2.style.display = "block";
        }

        closeBtn.onclick = function() {
        modal.style.display = "none";
        }

        closeBtn_2.onclick = function() {
        modal_2.style.display = "none";
        }

        window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }}

        var gamesData = [
            {% for game in top_five_games %}
        { label: "{{ game.name | safe | urldecode}}", y: {{ game.total_time_played }}, duration: "{{ game.formatted_duration }}" },
        {% endfor %}
        ];
        console.log(gamesData)

        var chart = new CanvasJS.Chart("chartContainer", {
            theme: "light2", // "light1", "light2", "dark1", "dark2"
            exportEnabled: true,
            animationEnabled: true,
            title: {
                text: "Top 10 des jeux les plus joués"
            },
            data: [{
                type: "doughnut",
                dataPoints: gamesData,
                toolTipContent: "{label}: {duration}"
            }]
        });

        function searchTable() {
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("searchInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("gameTable");
            tr = table.getElementsByTagName("tr");

            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td");
                for (var j = 0; j < td.length; j++) {
                    cell = tr[i].getElementsByTagName("td")[j];
                    if (cell) {
                        txtValue = cell.textContent || cell.innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            tr[i].style.display = "";
                            break;
                        } else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            }
        }
        chart.render();
    </script>
</body>

</html>